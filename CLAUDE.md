# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a Chinese language creative writing project called "GPT Story Maker" - a light novel/web novel with a complex multi-dimensional storyline. The protagonist Lin Wanwan is a medical student who transmigrates into a cultivation world and develops the ability to summon multiple versions of herself from parallel realities through quantum superposition states.

## Repository Structure

- **Vol1-5/**: Volume-specific chapter designs and content
- **设定/**: Complete story settings and design documents (see Document Hierarchy below)

## Story Architecture

**Core Concept**: Quantum superposition mechanics where the protagonist exists in multiple states simultaneously, manifesting as up to 42 different personalities/versions of herself.

**Key Elements**:
- Multi-dimensional personality system based on quantum mechanics
- Cultivation world setting with modern scientific knowledge integration
- Progressive power system tied to cultivation realms (Qi Refinement → Foundation Building → Golden Core → Nascent Soul)
- Philosophical themes around identity, choice, and the nature of existence
- The number "42" as a central motif (reference to Hitchhiker's Guide to the Galaxy)

## Core Characters

**Detailed character profiles available in `设定/人格图鉴.md`**

Key personalities: Lin Wanwan (Original), System 009, and 42 parallel personalities including core ones (#1 Yandere, #2 Foodie, #7 Mathematician, #21 Child, #35 Lawyer, #42 Answer Keeper). Main antagonist: Chen Yi (The Unifier).

## Writing Guidelines

**Language**: Chinese (Simplified) | **Genre**: Xianxia light novel with quantum mechanics, comedy, and philosophy

**⚠️ All detailed writing standards in `设定/写作规范.md` - PRIMARY authority for style, dialogue formats, and language rules**

## Document Hierarchy and Management

**📊 完整文档架构请参考：`设定/文档层级关系.md`**

**Authority Structure** (order of precedence):
1. **设定/写作规范.md** - PRIMARY writing standards and style authority
2. **设定/人格设定统一规范.md** - Character personality settings authority (NEW)
3. **设定/章节创作检查清单模板.md** - Creation workflow authority (UPDATED)
4. **设定/大纲.md** - Master outline (plot/setting conflicts)
5. **设定/Vol[X]/第[X]卷详细剧情设计.md** - Volume-specific detailed plots (highest priority for specific chapters)
6. **设定/内容索引.md** - Navigation index for all settings (auto-generated)
7. **Other 设定/ files** - Supporting character, faction, and tracking data

**Document Index System**:
- **设定/内容索引.md** - Master content index for precise navigation
  - TOC section: Lists files with their index line ranges
  - File sections: Lists chapters with original file line ranges
  - Usage: Use Read tool with specific line numbers for accurate content extraction
  - Generated by: `tools/generate_index.py` (excludes story chapters, settings only)
  - **CRITICAL**: Must regenerate index after ANY settings file modification
  - Automation: Use git hooks and CI hooks to ensure index stays current

**Critical Workflow Rules**:
- Always check `设定/内容索引.md` first for document navigation  
- Use Read tool with specific line numbers for precise content extraction
- **人格设定变更** → 必须先在 `设定/人格设定统一规范.md` 完成，然后同步其他相关文档
- **Follow authority structure order** for resolving conflicts (详见 `设定/文档层级关系.md`)
- **文档层级关系** → 参考 `设定/文档层级关系.md` 了解完整的主从关系和更新流程

## Key Story Mechanics

**Complete mechanics in `设定/人格机制设定.md` and `设定/大纲.md`**

- 42 personalities via quantum superposition, linked to cultivation realms
- 5 volumes × 20 chapters = 100 total chapters  
- Power scaling: 1.8x-8x multipliers, internal meeting space with accelerated time

## AI-Assisted Workflow

This project uses a specialized AI agent for comprehensive quality assurance:

**Available Agent**:
- `comprehensive-story-checker`: Unified quality validation system that performs:
  - Settings compliance verification (against 设定/大纲.md and 设定/写作规范.md)
  - Character authenticity checking (dialogue consistency, personality voices)
  - Narrative coherence validation (scene transitions, plot logic)
  - Humor/philosophy balance assessment

**Quality Assurance Process**:
1. Generate/modify story content
2. Review and request plot/character adjustments
3. Use comprehensive-story-checker for complete validation
4. Agent automatically reads latest standards from 设定/写作规范.md before each check

## Development Notes

This is a pure creative writing project with no executable code. When working with these files, focus on:
- Maintaining narrative consistency across all setting documents
- Preserving distinct character voices for each personality
- Tracking plot threads and foreshadowing elements using 伏笔追踪表.md
- Ensuring philosophical themes remain coherent throughout the story
- Balancing humor with deeper existential questions
- You should always use chinese in the main text
- Update character lists as story develops
- You need to control each chapter to above 2000 words
- Pay attention to the plot's pacing, maintain appropriate suspense between chapters, and arouse the reader's desire to read
- **数字使用规范**：人格编号统一使用中文数字（小一、小二、小七、二十一号、三十五号、四十二号），不使用阿拉伯数字

## Index Maintenance

**⚠️ MANDATORY**: Regenerate `设定/内容索引.md` after ANY settings file modification:

**Manual Update**:
```bash
python tools/generate_index.py
```

**Recommended Automation**:
1. **Git Pre-commit Hook**: Auto-regenerate index before commits
2. **CI/CD Pipeline**: Validate index is current on pull requests

## Essential Writing Standards

**⚠️ Complete standards in `设定/写作规范.md` - READ FIRST before any writing**

Key formats: 系统009【dialogue】, Chinese numerals for personalities (小一、小二、小七、二十一号、三十五号、四十二号), 2000+ characters per chapter.

## Chapter Writing Workflow

**⚠️ Three-Layer Quality System - MANDATORY for every chapter**

### Pre-Writing Validation
1. **设定/内容索引.md** → locate relevant documents
2. **设定/写作规范.md** → confirm current standards  
3. **设定/Vol[X]/第[X]卷详细剧情设计.md** → specific plot (takes precedence)
4. **设定/章节创作检查清单模板.md** → systematic validation
5. Previous chapters → current story state

### Writing Process
- Follow dialogue formats and terminology from 写作规范.md
- Each scene serves clear narrative purpose  
- Maintain character personality consistency
- Balance action, dialogue, internal monologue

### Post-Writing Validation  
- Technical: 2000+ characters, proper formatting
- Content: Logic consistency, character knowledge states
- Quality: Plot advancement, character development
- **Final**: Use `comprehensive-story-checker` agent

**Key Rule**: Detailed plot design files always take precedence over general outline
